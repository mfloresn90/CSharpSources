<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:sprite;/Areas/Epx/Themes/Windows/Content:0&amp;amp;hashKey=15EDE1F25211E852032D2691D5FEB7B8" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/9d0720cf-bf50-484c-bf6c-77cf57a10f7cCombined.css,0:sprite,1:LinkList;/Areas/Epx/Themes/Windows/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=52ADCBE5376E50AE6798D3D038D063E9" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Windows Runtime XML data API sample</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" /><link href="description/f1d4cd5b-ee0e-41ab-9a4f-a8fc36768c28Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Windows Runtime XML data API sample</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Windows Runtime
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Data Access
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Windows RT
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">11/25/2013</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/windowsapps/XML-API-Scenario-Sample-42ce708b">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<div id="mainSection">
<p>This sample demonstrates common XML API use scenarios for the <a href="http://msdn.microsoft.com/library/windows/apps/br240819">
<b>Windows.Data.Xml.Dom</b></a> and <a href="http://msdn.microsoft.com/library/windows/apps/br225376">
<b>Windows.Data.Xml.Xsl</b></a> namespaces in the Windows Runtime. </p>
<p>The five scenarios demonstrated in this sample are: </p>
<ul>
<li>Scenario1: loading an RSS template XML file asynchronously and adding a CData section. The asynchronous loading is accomplished by using the
<a href="http://msdn.microsoft.com/library/windows/apps/br206261"><b>XmlDocument.loadFromFileAsync</b></a> method from the
<a href="http://msdn.microsoft.com/library/windows/apps/br240819"><b>Windows.Data.Xml.Dom</b></a> namespace.
<a href="http://msdn.microsoft.com/library/windows/apps/br206238"><b>The XmlDocument.CreateCDataSection</b></a> method is used to add the CDATA section to the RSS file.
</li><li>Scenario 2: traversing a Document Object Model (DOM) tree to update the data and save it to a file. When the user presses the<b> Mark Hot Products
</b>button, an XPath query is used to select products from an XML file, which have an attribute named &quot;Sell10day&quot; that exceeds the attribute named &quot;InStore&quot;. The &quot;Sell10Day&quot; value represents the quantity sold in the last ten days. These products are marked
 &quot;hot&quot; by setting the &quot;hot&quot; attribute for the product to 1. When the user presses the
<b>Save</b> button, the <a href="http://msdn.microsoft.com/library/windows/apps/br206284">
<b>XmlDocument.saveToFileAsync</b></a> method is used to save the XML file containing the products list.
</li><li>Scenario 3: using the security settings prohibitDTD and resolveExternals when loading an XML file. prohibitDTD will prevent DTD use in a XML file. A large number of DTD entity references can cause an application to become unresponsive when loading and parsing
 an XML file. resolveExternals determines whether external references can be resolved during parsing. For this scenario, a user chooses a combination of these two security settings, which are properties on the XmlLoadSettings class used with the
<a href="http://msdn.microsoft.com/library/windows/apps/br206261"><b>XmlDocument.loadFromFileAsync</b></a> method. The user presses the
<b>Load XML File</b> button to view the resulting XML or error. </li><li>Scenario 4: using an XPath with the XML API for the Windows Runtime to select and filter data in a DOM tree. When a user presses the
<b>Show Anniversary Gift</b> button, the scenario constructs an array of XPath queries used by the
<a href="http://msdn.microsoft.com/library/windows/apps/br206285"><b>XmlDocument.SelectNodes</b></a> method against an XML file to determine an anniversary gift for each employee based on the year the employee started the job.
<ul>
<li>Employees with between 1 and 4 years on the job receive a gift card. </li><li>Employees with between 5 and 9 years on the job receive an XBOX. </li><li>Employees with 10 or more years on the job receive a Windows Phone. </li></ul>
</li><li>Scenario 5: using eXtensible Stylesheet Language Transformations (XSLT) with the XML APIs to transform an XML file into an HTML webpage. The source XML and XSL are loaded during initialization of the scenario. The XSL transform is applied when the user
 presses the <b>Transform</b> button. The Source XML and Source XSL can both be modified during runtime to see different results when applying an XSL transform. The transform is applied using the
<a href="http://msdn.microsoft.com/library/windows/apps/br225377"><b>XsltProcessor</b></a> class from the
<a href="http://msdn.microsoft.com/library/windows/apps/br225376"><b>Windows.Data.Xml.Xsl</b></a> namespace.
</li></ul>
<p></p>
<ul>
<li><a href="http://msdn.microsoft.com/library/windows/apps/br240819"><b>Windows.Data.Xml.Dom</b></a>
</li><li><a href="http://msdn.microsoft.com/library/windows/apps/br225376"><b>Windows.Data.Xml.Xsl</b></a>
</li></ul>
<p>To obtain an evaluation copy of Windows&nbsp;8.1, go to <a href="http://go.microsoft.com/fwlink/p/?linkid=301696">
Windows&nbsp;8.1</a>.</p>
<p>To obtain an evaluation copy of Microsoft Visual Studio&nbsp;2013, go to <a href="http://go.microsoft.com/fwlink/p/?linkid=301697">
Visual Studio&nbsp;2013</a>.</p>
<p></p>
<p class="note"><b>Note</b>&nbsp;&nbsp;For Windows&nbsp;8 app samples, download the <a href="http://go.microsoft.com/fwlink/p/?LinkId=301698">
Windows&nbsp;8 app samples pack</a>. The samples in the Windows&nbsp;8 app samples pack will build and run only on Microsoft Visual Studio&nbsp;2012.</p>
<p></p>
<h2><a id="related_topics"></a>Related topics</h2>
<dl><dt><a href="http://go.microsoft.com/fwlink/p/?LinkID=227694">Windows 8 app samples</a>
</dt></dl>
<h2>Related technologies</h2>
<a href="http://msdn.microsoft.com/library/windows/apps/br240819">Windows.Data.Xml.Dom</a> ,
<a href="http://msdn.microsoft.com/library/windows/apps/br225376">Windows.Data.Xml.Xsl</a>
<h2>Operating system requirements</h2>
<table>
<tbody>
<tr>
<th>Client</th>
<td><dt>Windows&nbsp;8.1 </dt></td>
</tr>
<tr>
<th>Server</th>
<td><dt>Windows Server&nbsp;2012&nbsp;R2 </dt></td>
</tr>
</tbody>
</table>
<h2>Build the sample</h2>
<ol>
<li>Start Visual Studio&nbsp;2013 and select <b>File &gt; Open &gt; Project/Solution</b>.
</li><li>Go to the directory in which you unzipped the sample. Go to the directory named for the sample, and double-click the Microsoft Visual Studio Solution (.sln) file.
</li><li>Press F7 or use <b>Build &gt; Build Solution</b> to build the sample. </li></ol>
<h2>Run the sample</h2>
<p>To run this sample after building it, go to the installation folder for this sample with launch Default.html in your browser. It is located in the &lt;install_root&gt;\bin\Debug folder. Alternatively in Visual Studio&nbsp;2013 for Windows&nbsp;8.1, press F5 (run with
 debugging enabled) or Ctrl&#43;F5 (run without debugging enabled). (Or select the corresponding options from the
<b>Debug</b> menu.)</p>
<p>Click a scenario to run.</p>
<p></p>
<ul>
<li>Scenario 1 is executed by typing some text in the RSS Content text box and pressing the
<b>Build RSS Feed</b> button. </li><li>Scenario 2 is executed by clicking the <b>Mark Hot Products</b> button. Clicking the
<b>Save</b> button will save the updated XML to the Libraries\Documents\HotProducts.xml file.
</li><li>Scenario 3 is executed by clicking a security setting combination and then clicking the
<b>Load XML File</b> button. </li><li>Scenario 4 is executed clicking the <b>Show Anniversary Gift</b> button. </li><li>Scenario 5 is executed by clicking the <b>Transform</b> button. You can also modify the source XML and XSL to see different results.
</li></ul>
<p></p>
</div>

</div>


    </div>
</body>
</html>

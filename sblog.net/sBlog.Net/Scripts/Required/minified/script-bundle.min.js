
﻿
$(document).ready(function(){$('.chkClickable').live('click',function(){$(this).next('.hdnStatus').val($(this).is(':checked'));});$('#btnAdd').click(function(){var text=$('#txtCat').val().trim();var regex=/\<[\S* ]*\>/;var alphaRegex=/[a-zA-Z]{1,}/;if(text.match(regex)!=null){showMessage('Category name entered is invalid');return;}
if(text.match(alphaRegex)==null){showMessage('Category name entered is invalid, should have at least 1 alphabet');return;}
if(text!=''&&!isPresent(text)){if(text.length<=50){ajaxAdd(text);}
else{showMessage('Category name cannot be more than 50 characters');}}});});function showMessage(message){alert(message);$('#txtCat').val('').focus();}
function isPresent(text){var status=false;var elements=$("label[for^='chkBox_selectcategories_']");$(elements).each(function(){if($(this).text()==text){status=true;var currentTop=$(this).offset().top;var parentTop=$('.cpCheckBoxContent').position().top;$('.cpCheckBoxContent').scrollTop(currentTop-parentTop);$('#txtCat').val('');}});return status;}
function ajaxAdd(text){$.ajax({type:'GET',url:'/Admin/CategoryAdmin/AddCategory',data:{'categoryName':text},success:function(data){if(data!=null&&data.CategoryID!=0){addCategory(data.CategoryName,data.CategoryID);$(".cpCheckBoxContent").animate({scrollTop:$(".cpCheckBoxContent").prop("scrollHeight")},1000);}
$('#txtCat').val('');},error:function(req,status,err){alert('an error occurred');}});}
function addCategory(name,value){var max=parseInt($("input[id^='valValue_selectcategories_']").last().attr('id').split('_')[2])+1;var element1=document.createElement('input');$(element1).attr('id','valValue_selectcategories_'+max).attr('name','valValue_selectcategories_'+max).attr('type','hidden').attr('value',value);var element2=document.createElement('input');$(element2).attr('id','chkBox_selectcategories_'+max).attr('name','chkBox_selectcategories_'+max).attr('type','checkbox').attr('class','chkClickable').attr('checked','checked').attr('value','true');var element3=document.createElement('input');$(element3).attr('id','hdnChk_selectcategories_'+max).attr('name','hdnChk_selectcategories_'+max).attr('type','hidden').attr('class','hdnStatus').attr('value','true');var element4=document.createElement('label');$(element4).attr('for','chkBox_selectcategories_'+max);element4.innerHTML="&nbsp;"+name;var element5=document.createElement('input');$(element5).attr('id','lblLabel_selectcategories_'+max).attr('name','lblLabel_selectcategories_'+max).attr('type','hidden').attr('value',name);var element6=document.createElement('br');$('.cpCheckBoxContent').append(element1).append(element2).append(element3).append(element4).append(element5).append(element6);}
﻿
(function($){var data_click="unobtrusiveAjaxClick",data_validation="unobtrusiveValidation";function getFunction(code,argNames){var fn=window,parts=(code||"").split(".");while(fn&&parts.length){fn=fn[parts.shift()];}
if(typeof(fn)==="function"){return fn;}
argNames.push(code);return Function.constructor.apply(null,argNames);}
function isMethodProxySafe(method){return method==="GET"||method==="POST";}
function asyncOnBeforeSend(xhr,method){if(!isMethodProxySafe(method)){xhr.setRequestHeader("X-HTTP-Method-Override",method);}}
function asyncOnSuccess(element,data,contentType){var mode;if(contentType.indexOf("application/x-javascript")!==-1){return;}
mode=(element.getAttribute("data-ajax-mode")||"").toUpperCase();$(element.getAttribute("data-ajax-update")).each(function(i,update){var top;switch(mode){case"BEFORE":top=update.firstChild;$("<div />").html(data).contents().each(function(){update.insertBefore(this,top);});break;case"AFTER":$("<div />").html(data).contents().each(function(){update.appendChild(this);});break;default:$(update).html(data);break;}});}
function asyncRequest(element,options){var confirm,loading,method,duration;confirm=element.getAttribute("data-ajax-confirm");if(confirm&&!window.confirm(confirm)){return;}
loading=$(element.getAttribute("data-ajax-loading"));duration=element.getAttribute("data-ajax-loading-duration")||0;$.extend(options,{type:element.getAttribute("data-ajax-method")||undefined,url:element.getAttribute("data-ajax-url")||undefined,beforeSend:function(xhr){var result;asyncOnBeforeSend(xhr,method);result=getFunction(element.getAttribute("data-ajax-begin"),["xhr"]).apply(this,arguments);if(result!==false){loading.show(duration);}
return result;},complete:function(){loading.hide(duration);getFunction(element.getAttribute("data-ajax-complete"),["xhr","status"]).apply(this,arguments);},success:function(data,status,xhr){asyncOnSuccess(element,data,xhr.getResponseHeader("Content-Type")||"text/html");getFunction(element.getAttribute("data-ajax-success"),["data","status","xhr"]).apply(this,arguments);},error:getFunction(element.getAttribute("data-ajax-failure"),["xhr","status","error"])});options.data.push({name:"X-Requested-With",value:"XMLHttpRequest"});method=options.type.toUpperCase();if(!isMethodProxySafe(method)){options.type="POST";options.data.push({name:"X-HTTP-Method-Override",value:method});}
$.ajax(options);}
function validate(form){var validationInfo=$(form).data(data_validation);return!validationInfo||!validationInfo.validate||validationInfo.validate();}
$("a[data-ajax=true]").live("click",function(evt){evt.preventDefault();asyncRequest(this,{url:this.href,type:"GET",data:[]});});$("form[data-ajax=true] input[type=image]").live("click",function(evt){var name=evt.target.name,$target=$(evt.target),form=$target.parents("form")[0],offset=$target.offset();$(form).data(data_click,[{name:name+".x",value:Math.round(evt.pageX-offset.left)},{name:name+".y",value:Math.round(evt.pageY-offset.top)}]);setTimeout(function(){$(form).removeData(data_click);},0);});$("form[data-ajax=true] :submit").live("click",function(evt){var name=evt.target.name,form=$(evt.target).parents("form")[0];$(form).data(data_click,name?[{name:name,value:evt.target.value}]:[]);setTimeout(function(){$(form).removeData(data_click);},0);});$("form[data-ajax=true]").live("submit",function(evt){var clickInfo=$(this).data(data_click)||[];evt.preventDefault();if(!validate(this)){return;}
asyncRequest(this,{url:this.action,type:this.method||"GET",data:clickInfo.concat($(this).serializeArray())});});}(jQuery));(function($){$.extend($.fn,{validate:function(options){if(!this.length){options&&options.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return;}
var validator=$.data(this[0],'validator');if(validator){return validator;}
validator=new $.validator(options,this[0]);$.data(this[0],'validator',validator);if(validator.settings.onsubmit){this.find("input, button").filter(".cancel").click(function(){validator.cancelSubmit=true;});if(validator.settings.submitHandler){this.find("input, button").filter(":submit").click(function(){validator.submitButton=this;});}
this.submit(function(event){if(validator.settings.debug)
event.preventDefault();function handle(){if(validator.settings.submitHandler){if(validator.submitButton){var hidden=$("<input type='hidden'/>").attr("name",validator.submitButton.name).val(validator.submitButton.value).appendTo(validator.currentForm);}
validator.settings.submitHandler.call(validator,validator.currentForm);if(validator.submitButton){hidden.remove();}
return false;}
return true;}
if(validator.cancelSubmit){validator.cancelSubmit=false;return handle();}
if(validator.form()){if(validator.pendingRequest){validator.formSubmitted=true;return false;}
return handle();}else{validator.focusInvalid();return false;}});}
return validator;},valid:function(){if($(this[0]).is('form')){return this.validate().form();}else{var valid=true;var validator=$(this[0].form).validate();this.each(function(){valid&=validator.element(this);});return valid;}},removeAttrs:function(attributes){var result={},$element=this;$.each(attributes.split(/\s/),function(index,value){result[value]=$element.attr(value);$element.removeAttr(value);});return result;},rules:function(command,argument){var element=this[0];if(command){var settings=$.data(element.form,'validator').settings;var staticRules=settings.rules;var existingRules=$.validator.staticRules(element);switch(command){case"add":$.extend(existingRules,$.validator.normalizeRule(argument));staticRules[element.name]=existingRules;if(argument.messages)
settings.messages[element.name]=$.extend(settings.messages[element.name],argument.messages);break;case"remove":if(!argument){delete staticRules[element.name];return existingRules;}
var filtered={};$.each(argument.split(/\s/),function(index,method){filtered[method]=existingRules[method];delete existingRules[method];});return filtered;}}
var data=$.validator.normalizeRules($.extend({},$.validator.metadataRules(element),$.validator.classRules(element),$.validator.attributeRules(element),$.validator.staticRules(element)),element);if(data.required){var param=data.required;delete data.required;data=$.extend({required:param},data);}
return data;}});$.extend($.expr[":"],{blank:function(a){return!$.trim(""+a.value);},filled:function(a){return!!$.trim(""+a.value);},unchecked:function(a){return!a.checked;}});$.validator=function(options,form){this.settings=$.extend(true,{},$.validator.defaults,options);this.currentForm=form;this.init();};$.validator.format=function(source,params){if(arguments.length==1)
return function(){var args=$.makeArray(arguments);args.unshift(source);return $.validator.format.apply(this,args);};if(arguments.length>2&&params.constructor!=Array){params=$.makeArray(arguments).slice(1);}
if(params.constructor!=Array){params=[params];}
$.each(params,function(i,n){source=source.replace(new RegExp("\\{"+i+"\\}","g"),n);});return source;};$.extend($.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:$([]),errorLabelContainer:$([]),onsubmit:true,ignore:[],ignoreTitle:false,onfocusin:function(element){this.lastActive=element;if(this.settings.focusCleanup&&!this.blockFocusCleanup){this.settings.unhighlight&&this.settings.unhighlight.call(this,element,this.settings.errorClass,this.settings.validClass);this.addWrapper(this.errorsFor(element)).hide();}},onfocusout:function(element){if(!this.checkable(element)&&(element.name in this.submitted||!this.optional(element))){this.element(element);}},onkeyup:function(element){if(element.name in this.submitted||element==this.lastElement){this.element(element);}},onclick:function(element){if(element.name in this.submitted)
this.element(element);else if(element.parentNode.name in this.submitted)
this.element(element.parentNode);},highlight:function(element,errorClass,validClass){$(element).addClass(errorClass).removeClass(validClass);},unhighlight:function(element,errorClass,validClass){$(element).removeClass(errorClass).addClass(validClass);}},setDefaults:function(settings){$.extend($.validator.defaults,settings);},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:$.validator.format("Please enter no more than {0} characters."),minlength:$.validator.format("Please enter at least {0} characters."),rangelength:$.validator.format("Please enter a value between {0} and {1} characters long."),range:$.validator.format("Please enter a value between {0} and {1}."),max:$.validator.format("Please enter a value less than or equal to {0}."),min:$.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=$(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||$(this.currentForm);this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var groups=(this.groups={});$.each(this.settings.groups,function(key,value){$.each(value.split(/\s/),function(index,name){groups[name]=key;});});var rules=this.settings.rules;$.each(rules,function(key,value){rules[key]=$.validator.normalizeRule(value);});function delegate(event){var validator=$.data(this[0].form,"validator"),eventType="on"+event.type.replace(/^validate/,"");validator.settings[eventType]&&validator.settings[eventType].call(validator,this[0]);}
$(this.currentForm).validateDelegate(":text, :password, :file, select, textarea","focusin focusout keyup",delegate).validateDelegate(":radio, :checkbox, select, option","click",delegate);if(this.settings.invalidHandler)
$(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler);},form:function(){this.checkForm();$.extend(this.submitted,this.errorMap);this.invalid=$.extend({},this.errorMap);if(!this.valid())
$(this.currentForm).triggerHandler("invalid-form",[this]);this.showErrors();return this.valid();},checkForm:function(){this.prepareForm();for(var i=0,elements=(this.currentElements=this.elements());elements[i];i++){this.check(elements[i]);}
return this.valid();},element:function(element){element=this.clean(element);this.lastElement=element;this.prepareElement(element);this.currentElements=$(element);var result=this.check(element);if(result){delete this.invalid[element.name];}else{this.invalid[element.name]=true;}
if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers);}
this.showErrors();return result;},showErrors:function(errors){if(errors){$.extend(this.errorMap,errors);this.errorList=[];for(var name in errors){this.errorList.push({message:errors[name],element:this.findByName(name)[0]});}
this.successList=$.grep(this.successList,function(element){return!(element.name in errors);});}
this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors();},resetForm:function(){if($.fn.resetForm)
$(this.currentForm).resetForm();this.submitted={};this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass);},numberOfInvalids:function(){return this.objectLength(this.invalid);},objectLength:function(obj){var count=0;for(var i in obj)
count++;return count;},hideErrors:function(){this.addWrapper(this.toHide).hide();},valid:function(){return this.size()==0;},size:function(){return this.errorList.length;},focusInvalid:function(){if(this.settings.focusInvalid){try{$(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin");}catch(e){}}},findLastActive:function(){var lastActive=this.lastActive;return lastActive&&$.grep(this.errorList,function(n){return n.element.name==lastActive.name;}).length==1&&lastActive;},elements:function(){var validator=this,rulesCache={};return $([]).add(this.currentForm.elements).filter(":input").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){!this.name&&validator.settings.debug&&window.console&&console.error("%o has no name assigned",this);if(this.name in rulesCache||!validator.objectLength($(this).rules()))
return false;rulesCache[this.name]=true;return true;});},clean:function(selector){return $(selector)[0];},errors:function(){return $(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext);},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=$([]);this.toHide=$([]);this.currentElements=$([]);},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers);},prepareElement:function(element){this.reset();this.toHide=this.errorsFor(element);},check:function(element){element=this.clean(element);if(this.checkable(element)){element=this.findByName(element.name).not(this.settings.ignore)[0];}
var rules=$(element).rules();var dependencyMismatch=false;for(var method in rules){var rule={method:method,parameters:rules[method]};try{var result=$.validator.methods[method].call(this,element.value.replace(/\r/g,""),element,rule.parameters);if(result=="dependency-mismatch"){dependencyMismatch=true;continue;}
dependencyMismatch=false;if(result=="pending"){this.toHide=this.toHide.not(this.errorsFor(element));return;}
if(!result){this.formatAndAdd(element,rule);return false;}}catch(e){this.settings.debug&&window.console&&console.log("exception occured when checking element "+element.id
+", check the '"+rule.method+"' method",e);throw e;}}
if(dependencyMismatch)
return;if(this.objectLength(rules))
this.successList.push(element);return true;},customMetaMessage:function(element,method){if(!$.metadata)
return;var meta=this.settings.meta?$(element).metadata()[this.settings.meta]:$(element).metadata();return meta&&meta.messages&&meta.messages[method];},customMessage:function(name,method){var m=this.settings.messages[name];return m&&(m.constructor==String?m:m[method]);},findDefined:function(){for(var i=0;i<arguments.length;i++){if(arguments[i]!==undefined)
return arguments[i];}
return undefined;},defaultMessage:function(element,method){return this.findDefined(this.customMessage(element.name,method),this.customMetaMessage(element,method),!this.settings.ignoreTitle&&element.title||undefined,$.validator.messages[method],"<strong>Warning: No message defined for "+element.name+"</strong>");},formatAndAdd:function(element,rule){var message=this.defaultMessage(element,rule.method),theregex=/\$?\{(\d+)\}/g;if(typeof message=="function"){message=message.call(this,rule.parameters,element);}else if(theregex.test(message)){message=jQuery.format(message.replace(theregex,'{$1}'),rule.parameters);}
this.errorList.push({message:message,element:element});this.errorMap[element.name]=message;this.submitted[element.name]=message;},addWrapper:function(toToggle){if(this.settings.wrapper)
toToggle=toToggle.add(toToggle.parent(this.settings.wrapper));return toToggle;},defaultShowErrors:function(){for(var i=0;this.errorList[i];i++){var error=this.errorList[i];this.settings.highlight&&this.settings.highlight.call(this,error.element,this.settings.errorClass,this.settings.validClass);this.showLabel(error.element,error.message);}
if(this.errorList.length){this.toShow=this.toShow.add(this.containers);}
if(this.settings.success){for(var i=0;this.successList[i];i++){this.showLabel(this.successList[i]);}}
if(this.settings.unhighlight){for(var i=0,elements=this.validElements();elements[i];i++){this.settings.unhighlight.call(this,elements[i],this.settings.errorClass,this.settings.validClass);}}
this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show();},validElements:function(){return this.currentElements.not(this.invalidElements());},invalidElements:function(){return $(this.errorList).map(function(){return this.element;});},showLabel:function(element,message){var label=this.errorsFor(element);if(label.length){label.removeClass().addClass(this.settings.errorClass);label.attr("generated")&&label.html(message);}else{label=$("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(element),generated:true}).addClass(this.settings.errorClass).html(message||"");if(this.settings.wrapper){label=label.hide().show().wrap("<"+this.settings.wrapper+"/>").parent();}
if(!this.labelContainer.append(label).length)
this.settings.errorPlacement?this.settings.errorPlacement(label,$(element)):label.insertAfter(element);}
if(!message&&this.settings.success){label.text("");typeof this.settings.success=="string"?label.addClass(this.settings.success):this.settings.success(label);}
this.toShow=this.toShow.add(label);},errorsFor:function(element){var name=this.idOrName(element);return this.errors().filter(function(){return $(this).attr('for')==name;});},idOrName:function(element){return this.groups[element.name]||(this.checkable(element)?element.name:element.id||element.name);},checkable:function(element){return/radio|checkbox/i.test(element.type);},findByName:function(name){var form=this.currentForm;return $(document.getElementsByName(name)).map(function(index,element){return element.form==form&&element.name==name&&element||null;});},getLength:function(value,element){switch(element.nodeName.toLowerCase()){case'select':return $("option:selected",element).length;case'input':if(this.checkable(element))
return this.findByName(element.name).filter(':checked').length;}
return value.length;},depend:function(param,element){return this.dependTypes[typeof param]?this.dependTypes[typeof param](param,element):true;},dependTypes:{"boolean":function(param,element){return param;},"string":function(param,element){return!!$(param,element.form).length;},"function":function(param,element){return param(element);}},optional:function(element){return!$.validator.methods.required.call(this,$.trim(element.value),element)&&"dependency-mismatch";},startRequest:function(element){if(!this.pending[element.name]){this.pendingRequest++;this.pending[element.name]=true;}},stopRequest:function(element,valid){this.pendingRequest--;if(this.pendingRequest<0)
this.pendingRequest=0;delete this.pending[element.name];if(valid&&this.pendingRequest==0&&this.formSubmitted&&this.form()){$(this.currentForm).submit();this.formSubmitted=false;}else if(!valid&&this.pendingRequest==0&&this.formSubmitted){$(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false;}},previousValue:function(element){return $.data(element,"previousValue")||$.data(element,"previousValue",{old:null,valid:true,message:this.defaultMessage(element,"remote")});}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},dateDE:{dateDE:true},number:{number:true},numberDE:{numberDE:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(className,rules){className.constructor==String?this.classRuleSettings[className]=rules:$.extend(this.classRuleSettings,className);},classRules:function(element){var rules={};var classes=$(element).attr('class');classes&&$.each(classes.split(' '),function(){if(this in $.validator.classRuleSettings){$.extend(rules,$.validator.classRuleSettings[this]);}});return rules;},attributeRules:function(element){var rules={};var $element=$(element);for(var method in $.validator.methods){var value=$element.attr(method);if(value){rules[method]=value;}}
if(rules.maxlength&&/-1|2147483647|524288/.test(rules.maxlength)){delete rules.maxlength;}
return rules;},metadataRules:function(element){if(!$.metadata)return{};var meta=$.data(element.form,'validator').settings.meta;return meta?$(element).metadata()[meta]:$(element).metadata();},staticRules:function(element){var rules={};var validator=$.data(element.form,'validator');if(validator.settings.rules){rules=$.validator.normalizeRule(validator.settings.rules[element.name])||{};}
return rules;},normalizeRules:function(rules,element){$.each(rules,function(prop,val){if(val===false){delete rules[prop];return;}
if(val.param||val.depends){var keepRule=true;switch(typeof val.depends){case"string":keepRule=!!$(val.depends,element.form).length;break;case"function":keepRule=val.depends.call(element,element);break;}
if(keepRule){rules[prop]=val.param!==undefined?val.param:true;}else{delete rules[prop];}}});$.each(rules,function(rule,parameter){rules[rule]=$.isFunction(parameter)?parameter(element):parameter;});$.each(['minlength','maxlength','min','max'],function(){if(rules[this]){rules[this]=Number(rules[this]);}});$.each(['rangelength','range'],function(){if(rules[this]){rules[this]=[Number(rules[this][0]),Number(rules[this][1])];}});if($.validator.autoCreateRanges){if(rules.min&&rules.max){rules.range=[rules.min,rules.max];delete rules.min;delete rules.max;}
if(rules.minlength&&rules.maxlength){rules.rangelength=[rules.minlength,rules.maxlength];delete rules.minlength;delete rules.maxlength;}}
if(rules.messages){delete rules.messages;}
return rules;},normalizeRule:function(data){if(typeof data=="string"){var transformed={};$.each(data.split(/\s/),function(){transformed[this]=true;});data=transformed;}
return data;},addMethod:function(name,method,message){$.validator.methods[name]=method;$.validator.messages[name]=message!=undefined?message:$.validator.messages[name];if(method.length<3){$.validator.addClassRules(name,$.validator.normalizeRule(name));}},methods:{required:function(value,element,param){if(!this.depend(param,element))
return"dependency-mismatch";switch(element.nodeName.toLowerCase()){case'select':var val=$(element).val();return val&&val.length>0;case'input':if(this.checkable(element))
return this.getLength(value,element)>0;default:return $.trim(value).length>0;}},remote:function(value,element,param){if(this.optional(element))
return"dependency-mismatch";var previous=this.previousValue(element);if(!this.settings.messages[element.name])
this.settings.messages[element.name]={};previous.originalMessage=this.settings.messages[element.name].remote;this.settings.messages[element.name].remote=previous.message;param=typeof param=="string"&&{url:param}||param;if(this.pending[element.name]){return"pending";}
if(previous.old===value){return previous.valid;}
previous.old=value;var validator=this;this.startRequest(element);var data={};data[element.name]=value;$.ajax($.extend(true,{url:param,mode:"abort",port:"validate"+element.name,dataType:"json",data:data,success:function(response){validator.settings.messages[element.name].remote=previous.originalMessage;var valid=response===true;if(valid){var submitted=validator.formSubmitted;validator.prepareElement(element);validator.formSubmitted=submitted;validator.successList.push(element);validator.showErrors();}else{var errors={};var message=response||validator.defaultMessage(element,"remote");errors[element.name]=previous.message=$.isFunction(message)?message(value):message;validator.showErrors(errors);}
previous.valid=valid;validator.stopRequest(element,valid);}},param));return"pending";},minlength:function(value,element,param){return this.optional(element)||this.getLength($.trim(value),element)>=param;},maxlength:function(value,element,param){return this.optional(element)||this.getLength($.trim(value),element)<=param;},rangelength:function(value,element,param){var length=this.getLength($.trim(value),element);return this.optional(element)||(length>=param[0]&&length<=param[1]);},min:function(value,element,param){return this.optional(element)||value>=param;},max:function(value,element,param){return this.optional(element)||value<=param;},range:function(value,element,param){return this.optional(element)||(value>=param[0]&&value<=param[1]);},email:function(value,element){return this.optional(element)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(value);},url:function(value,element){return this.optional(element)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(value);},date:function(value,element){return this.optional(element)||!/Invalid|NaN/.test(new Date(value));},dateISO:function(value,element){return this.optional(element)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(value);},number:function(value,element){return this.optional(element)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(value);},digits:function(value,element){return this.optional(element)||/^\d+$/.test(value);},creditcard:function(value,element){if(this.optional(element))
return"dependency-mismatch";if(/[^0-9-]+/.test(value))
return false;var nCheck=0,nDigit=0,bEven=false;value=value.replace(/\D/g,"");for(var n=value.length-1;n>=0;n--){var cDigit=value.charAt(n);var nDigit=parseInt(cDigit,10);if(bEven){if((nDigit*=2)>9)
nDigit-=9;}
nCheck+=nDigit;bEven=!bEven;}
return(nCheck%10)==0;},accept:function(value,element,param){param=typeof param=="string"?param.replace(/,/g,'|'):"png|jpe?g|gif";return this.optional(element)||value.match(new RegExp(".("+param+")$","i"));},equalTo:function(value,element,param){var target=$(param).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){$(element).valid();});return value==target.val();}}});$.format=$.validator.format;})(jQuery);;(function($){var pendingRequests={};if($.ajaxPrefilter){$.ajaxPrefilter(function(settings,_,xhr){var port=settings.port;if(settings.mode=="abort"){if(pendingRequests[port]){pendingRequests[port].abort();}
pendingRequests[port]=xhr;}});}else{var ajax=$.ajax;$.ajax=function(settings){var mode=("mode"in settings?settings:$.ajaxSettings).mode,port=("port"in settings?settings:$.ajaxSettings).port;if(mode=="abort"){if(pendingRequests[port]){pendingRequests[port].abort();}
return(pendingRequests[port]=ajax.apply(this,arguments));}
return ajax.apply(this,arguments);};}})(jQuery);;(function($){if(!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener){$.each({focus:'focusin',blur:'focusout'},function(original,fix){$.event.special[fix]={setup:function(){this.addEventListener(original,handler,true);},teardown:function(){this.removeEventListener(original,handler,true);},handler:function(e){arguments[0]=$.event.fix(e);arguments[0].type=fix;return $.event.handle.apply(this,arguments);}};function handler(e){e=$.event.fix(e);e.type=fix;return $.event.handle.call(this,e);}});};$.extend($.fn,{validateDelegate:function(delegate,type,handler){return this.bind(type,function(event){var target=$(event.target);if(target.is(delegate)){return handler.apply(target,arguments);}});}});})(jQuery);﻿
(function($){var $jQval=$.validator,adapters,data_validation="unobtrusiveValidation";function setValidationValues(options,ruleName,value){options.rules[ruleName]=value;if(options.message){options.messages[ruleName]=options.message;}}
function splitAndTrim(value){return value.replace(/^\s+|\s+$/g,"").split(/\s*,\s*/g);}
function getModelPrefix(fieldName){return fieldName.substr(0,fieldName.lastIndexOf(".")+1);}
function appendModelPrefix(value,prefix){if(value.indexOf("*.")===0){value=value.replace("*.",prefix);}
return value;}
function onError(error,inputElement){var container=$(this).find("[data-valmsg-for='"+inputElement[0].name+"']"),replace=$.parseJSON(container.attr("data-valmsg-replace"))!==false;container.removeClass("field-validation-valid").addClass("field-validation-error");error.data("unobtrusiveContainer",container);if(replace){container.empty();error.removeClass("input-validation-error").appendTo(container);}
else{error.hide();}}
function onErrors(form,validator){var container=$(this).find("[data-valmsg-summary=true]"),list=container.find("ul");if(list&&list.length&&validator.errorList.length){list.empty();container.addClass("validation-summary-errors").removeClass("validation-summary-valid");$.each(validator.errorList,function(){$("<li />").html(this.message).appendTo(list);});}}
function onSuccess(error){var container=error.data("unobtrusiveContainer"),replace=$.parseJSON(container.attr("data-valmsg-replace"));if(container){container.addClass("field-validation-valid").removeClass("field-validation-error");error.removeData("unobtrusiveContainer");if(replace){container.empty();}}}
function validationInfo(form){var $form=$(form),result=$form.data(data_validation);if(!result){result={options:{errorClass:"input-validation-error",errorElement:"span",errorPlacement:$.proxy(onError,form),invalidHandler:$.proxy(onErrors,form),messages:{},rules:{},success:$.proxy(onSuccess,form)},attachValidation:function(){$form.validate(this.options);},validate:function(){$form.validate();return $form.valid();}};$form.data(data_validation,result);}
return result;}
$jQval.unobtrusive={adapters:[],parseElement:function(element,skipAttach){var $element=$(element),form=$element.parents("form")[0],valInfo,rules,messages;if(!form){return;}
valInfo=validationInfo(form);valInfo.options.rules[element.name]=rules={};valInfo.options.messages[element.name]=messages={};$.each(this.adapters,function(){var prefix="data-val-"+this.name,message=$element.attr(prefix),paramValues={};if(message!==undefined){prefix+="-";$.each(this.params,function(){paramValues[this]=$element.attr(prefix+this);});this.adapt({element:element,form:form,message:message,params:paramValues,rules:rules,messages:messages});}});jQuery.extend(rules,{"__dummy__":true});if(!skipAttach){valInfo.attachValidation();}},parse:function(selector){$(selector).find(":input[data-val=true]").each(function(){$jQval.unobtrusive.parseElement(this,true);});$("form").each(function(){var info=validationInfo(this);if(info){info.attachValidation();}});}};adapters=$jQval.unobtrusive.adapters;adapters.add=function(adapterName,params,fn){if(!fn){fn=params;params=[];}
this.push({name:adapterName,params:params,adapt:fn});return this;};adapters.addBool=function(adapterName,ruleName){return this.add(adapterName,function(options){setValidationValues(options,ruleName||adapterName,true);});};adapters.addMinMax=function(adapterName,minRuleName,maxRuleName,minMaxRuleName,minAttribute,maxAttribute){return this.add(adapterName,[minAttribute||"min",maxAttribute||"max"],function(options){var min=options.params.min,max=options.params.max;if(min&&max){setValidationValues(options,minMaxRuleName,[min,max]);}
else if(min){setValidationValues(options,minRuleName,min);}
else if(max){setValidationValues(options,maxRuleName,max);}});};adapters.addSingleVal=function(adapterName,attribute,ruleName){return this.add(adapterName,[attribute||"val"],function(options){setValidationValues(options,ruleName||adapterName,options.params[attribute]);});};$jQval.addMethod("__dummy__",function(value,element,params){return true;});$jQval.addMethod("regex",function(value,element,params){var match;if(this.optional(element)){return true;}
match=new RegExp(params).exec(value);return(match&&(match.index===0)&&(match[0].length===value.length));});adapters.addSingleVal("accept","exts").addSingleVal("regex","pattern");adapters.addBool("creditcard").addBool("date").addBool("digits").addBool("email").addBool("number").addBool("url");adapters.addMinMax("length","minlength","maxlength","rangelength").addMinMax("range","min","max","range");adapters.add("equalto",["other"],function(options){var prefix=getModelPrefix(options.element.name),other=options.params.other,fullOtherName=appendModelPrefix(other,prefix),element=$(options.form).find(":input[name="+fullOtherName+"]")[0];setValidationValues(options,"equalTo",element);});adapters.add("required",function(options){if(options.element.tagName.toUpperCase()!=="INPUT"||options.element.type.toUpperCase()!=="CHECKBOX"){setValidationValues(options,"required",true);}});adapters.add("remote",["url","type","additionalfields"],function(options){var value={url:options.params.url,type:options.params.type||"GET",data:{}},prefix=getModelPrefix(options.element.name);$.each(splitAndTrim(options.params.additionalfields||options.element.name),function(i,fieldName){var paramName=appendModelPrefix(fieldName,prefix);value.data[paramName]=function(){return $(options.form).find(":input[name='"+paramName+"']").val();};});setValidationValues(options,"remote",value);});$(function(){$jQval.unobtrusive.parse(document);});}(jQuery));﻿
$(document).ready(function(){updatePublishBtn();$('.privateChkBox').change(function(){updatePublishBtn();});$('.postUrl,.postUrlPrefix,#btnUpdate,#btnCancel').hide();$('.postTitle').change(function(){var postId=parseInt($('#Post_PostID').val());if(postId==0){var text=$(this).val();if(text.trim()!=''){getVerifiedUrl(text);}else{clearUrlFields();}}});if($('.postUrlValue').val()!=null&&$('.postUrlValue').val()!=''){var prefixText='';if($('#Post_PostID').val()!='0'&&$('#Post_EntryType').val()=='1'){prefixText=getDatePrefix()+'/';}
else{prefixText='pages'+'/';}
$('.postUrlLabel').text(prefixText+$('.postUrlValue').val());$('.postUrlLabel').attr('title','click to change the url').bind('click',function(){$('.postUrl').show();$('.postUrlPrefix').show();$('.postUrlPrefix').text(prefixText);$('.postUrlLabel').hide();$('#btnUpdate').show();$('#btnCancel').show();});}
$('#btnUpdate').click(function(){var text=$('.postUrl').val();if(text.trim()==''){text=$('.postTitle').val();}
$('.postUrl,.postUrlPrefix').hide();$('.postUrlLabel').show();$('#btnUpdate').hide();$('#btnCancel').hide();if(text.trim()!=''){getVerifiedUrl(text);}
else{clearUrlFields();}});$('#btnCancel').click(function(){$('.postUrl,.postUrlPrefix').hide();$('.postUrlLabel').show();$('#btnUpdate').hide();$('#btnCancel').hide();});$(document).on('focus','#bitlyLink',function(){$(this).one('mouseup',function(event){event.preventDefault();}).select();});if($('#isPartiallySavable').length==1){setTimeout(function(){savePostOrPage();},30000);}
if($('.hide-column').length>0){var cell=$('.hide-column');var col=$(cell).parent().children().index(cell);var tbl=$(cell).parents('table');var rows=$(tbl).find('tbody').find('tr');$(cell).hide();$(rows).each(function(){$(this).find('td:eq('+col+')').hide();});}});function clearUrlFields(){$('.postUrlLabel').text('---').unbind('click');$('.postUrlPrefix').text('');$('.postUrlValue').val('');$('.postUrl').val('');}
function getDatePrefix(){var postDate=$('#Post_PostAddedDate').val();var prefix='',month='';if(postDate=='1/1/0001 12:00:00 AM'){var date=new Date;month=date.getMonth()+1;prefix=date.getFullYear()+'/'+(month>=10?month:("0"+month));}else{var parsedDate=new Date(Date.parse(postDate));month=parsedDate.getMonth()+1;prefix=parsedDate.getFullYear()+'/'+(month>=10?month:("0"+month));}
return prefix;}
function getVerifiedUrl(postTitle){var entryType=$('#Post_EntryType').val();var postId=$('#Post_PostID').val();$.ajax({type:'GET',url:siteRoot+'admin/post/verifyurlurlexists',data:{'postTitle':postTitle,'entryType':entryType,'postId':postId},dataType:'json',success:function(data){finalizeUrl(data);}});}
function finalizeUrl(text){$('.postUrl').val(text);var entryType=$('#Post_EntryType').val();var prefix='';if(entryType=="1"){prefix=getDatePrefix();text=prefix+'/'+text;}
else{prefix='pages';text='pages/'+text;}
$('.postUrlPrefix').text(prefix+'/');$('.postUrlValue').val(text);$('.postUrlLabel').text(text);$('.postUrlLabel').attr('title','click to change the url').bind('click',function(){$('.postUrl').show();$('.postUrlPrefix').show();$('.postUrlLabel').hide();$('#btnUpdate').show();$('#btnCancel').show();});}
$(document).ready(function(){$('#btnAddTags').click(function(e){e.preventDefault();showTagHelp();if($('#txtTag').val().trim()!=''){var array=getCleanedTagList($('#txtTag').val().trim());createTags(array);}
setHiddenVal();$('#txtTag').val('');$('#txtTag').focus();});$('.tag').live('click',function(){$(this).next().remove();$(this).remove();setHiddenVal();});if($('#hdnAddedTags').val()!=undefined&&$('#hdnAddedTags').val()!=''){var elements=$('#hdnAddedTags').val().split(',');createTags(elements);}});function showTagHelp(){$('#tag-info').show();setTimeout(function(){$('#tag-info').hide('fast');},1000);}
function getCleanedTagList(tagList){var array=tagList.split(',');var regex=/\<[\S* ]*\>/;var alphaRegex=/[a-zA-Z]{1,}/;var cleanedArray=[];var invalidTags=false;$.each(array,function(){var trimmedText=this.trim();if(trimmedText!=''){if(trimmedText.length<=50&&trimmedText.match(regex)==null&&trimmedText.match(alphaRegex)!=null){cleanedArray.push(trimmedText);}
else{invalidTags=true;}}});if(invalidTags){alert('Tags with length greater than 50, tags with html, tags without any alphabets were removed.');}
return cleanedArray;}
function notPresent(text){var result=true;var elements=$('#addedTags').find('span.tag');$(elements).each(function(){if($(this).html().toLowerCase()==text.toLowerCase()){result=false;}});return result;}
function setHiddenVal(){var hdnStr='';$('#addedTags').find('span.tag').each(function(){hdnStr+=$(this).text()+',';});hdnStr=hdnStr.substring(0,hdnStr.length-1);$('#hdnAddedTags').val(hdnStr);}
function createTags(array){$(array).each(function(){if(notPresent(this)){var element=document.createElement('span');$(element).attr('class','tag');$(element).attr('title','click to remove');element.innerHTML=this;$('#addedTags').append(element);var selement=document.createElement('span');selement.innerHTML='&nbsp;&nbsp;&nbsp;';$('#addedTags').append(selement);}});}
function updatePublishBtn(){var text=$('.privateChkBox').is(':checked')?"Save":"Publish";$('.publishBtn').attr('value',text);}
function updatePreview(){var selectedTheme=$('#Theme').val();if(selectedTheme==null||selectedTheme==''){selectedTheme="Default";}
var themeUrl=siteRoot+'Content/codeHighlighter/styles/shTheme'+selectedTheme+'.css';$('#themeChoice').attr('href',themeUrl);$('#previewMsg').hide();$('#preview').show();}
$(document).ready(function(){$('.brush-not-selected').hide();$('#chk-show-all').change(function(){if($(this).is(':checked')){$('.brush-not-selected').show();$('.selected-brushes-title').html('All brushes:');}
else{$('.brush-not-selected').hide();$('.selected-brushes-title').html('Selected brushes:');}});setTimeout(function(){updatePreview();},1000);$('#Theme').on('change',function(){updatePreview();});});$(document).ready(function(){var li=$('li.current');var submnu;if($(li).parent().attr('class')!='no-display sub-menu'){submnu=$(li).find('ul.sub-menu');$(submnu).removeClass('no-display').addClass('display');}
else{li=$('li.current').parent().parent();submnu=$(li).find('ul.sub-menu');$(submnu).removeClass('no-display').addClass('display');$(li).addClass('current');}
$('li.collapse').click(function(){$('#content').removeClass('content-actual').addClass('content-collapsed');$('#menu').hide();$('#quickLinks').hide();$('#restore').show();});$('a#restoreMenu').click(function(e){e.preventDefault();$('#content').removeClass('content-collapsed').addClass('content-actual');$('#menu').show();$('#quickLinks').show();$('#restore').hide();});$('.imgSharing').click(function(){var radio=$(this).parent().prev();$(radio).click();});});$(document).ready(function(){$('.deleteFile').click(function(){var prevCell=$(this).parent();var fileName=$(this).attr('data-file-name');var choice=confirm("Are you sure you want to delete "+fileName+"? It cannot be recovered once it is deleted. Click \"Ok\" to delete.");if(choice){$.ajax({type:'GET',url:siteRoot+'Admin/Uploads/DeleteUploadedFile',data:{'fileName':fileName,'token':$('#OneTimeCode').val()},dataType:'json',success:function(data){if(data.FileStatus=="File Deleted"){var zeroRowHtml='<tr><td>there are no items in this section at this point!</td><td></td></tr>';var row=$(prevCell).parent();$(row).remove();if($('#manage-table > tbody').find('tr').length==0){var tbody=$('#manage-table > tbody');$(tbody).append(zeroRowHtml);}}},error:function(req,status,err){alert('an error occurred while trying to delete the selected file, please try again.');}});}});});$(document).ready(function(){$('.trashComment').click(function(e){e.preventDefault();var anchor=this;var commentId=$(anchor).next('.trashCommentID').val();$.ajax({type:'GET',url:siteRoot+'Admin/CommentAdmin/TrashComment',data:{'commentId':parseInt(commentId),'token':$('#OneTimeCode').val()},dataType:'json',success:function(data){if(data.DeleteStatusString=="Delete succeeded"){var row=$(anchor).parent().parent().parent();$(row).remove();}},error:function(req,status,err){alert('an error occurred while trying to delete the selected comment, please try again.');}});});});$(document).ready(function(){$('#btnCreateTags').click(function(){var text=$('#txtTag').val().trim();var regex=/\<[\S* ]*\>/;var alphaRegex=/[a-zA-Z]{1,}/;if(text.match(regex)!=null){alert('Tag name entered is invalid');$('#txtTag').val('').focus();return;}
if(text.match(alphaRegex)==null){alert('Tag entered is invalid, should have at least 1 alphabet');$('#txtTag').val('').focus();return;}
if(text!=''&&text.indexOf(',')<0){ajaxAddTagPartial(text);}
else if(text!=''){$('.add-msg').html('invalid tag, cannot contain a \',\'').show('slow');setTimeout(function(){$('.add-msg').html('');$('#txtTag').val('').focus();},2000);}});$('.deletePost, .deletePage, .deleteCategory, .deleteTag, .deleteAuthor').live('click',function(e){e.preventDefault();var element=this;var url=$(element).attr('href')+"&token="+$('#OneTimeCode').val();var choice=confirm("Are you sure you want to delete the selected item?");if(choice){$.ajax({type:'GET',url:url,dataType:'json',success:function(data){deleteRow(element);},error:function(xhr,ajaxOptions,thrownError){alert('unable to delete the chosen item');}});}});});function deleteRow(element){var zeroRowsHtml='<tr class=\"manage-row\"><td class=\"manage-cell\">there are no items in this section at this point!</td><td class=\"manage-cell\"></td><td class=\"manage-cell\"></td></tr>';var row=$(element).parents('tr');$(row).remove();if($('#manage-table > tbody').find('tr').length==0){var tbody=$('#manage-table > tbody');$(tbody).append(zeroRowsHtml);}}
function ajaxAddTagPartial(text){$.ajax({type:'GET',url:siteRoot+'Admin/TagAdmin/AddTagPartial',data:{'tagName':text,'token':$('#OneTimeCode').val()},dataType:'html',success:function(data){if(data.trim()!=''){var zeroRow=$('tr.manage-row');$('#manage-table tbody tr:first').before(data);$('.add-msg').html('');if(zeroRow.length==1){$(zeroRow).remove();}}
else{$('.add-msg').html('tag already exists').show('slow');setTimeout(function(){$('.add-msg').html('');},2000);}
$('#txtTag').val('');},error:function(req,status,err){alert('an error occurred while trying to add the tag, please try again.');}});}
$(document).ready(function(){showHideMarkdownHelp($('#EditorType').val());$('#EditorType').on('change',function(){showHideMarkdownHelp($(this).val());});$('#AkismetEnabled').change(function(){$('.akismetAdvancedOptions').toggle();});if($('#AkismetEnabled').is(':checked')){$('.akismetAdvancedOptions').show();}});$(document).ready(function(){$('#btnLogin').click(function(){if($('#username').val().trim()==''||$('#password').val().trim()==''){$('.login-errors').html('Username and/or password is required').show();return false;}
$('.login-errors').hide().html('');return true;});});$(document).ready(function(){$('.col-no-display').each(function(){var index=$(this).index();if(index>0){$('#manage-table tr').each(function(){$(this).find('td:eq('+index+')').hide();});$('#manage-table tfoot tr').find('th:eq('+index+')').hide();$('.col-no-display').hide();}});});$(document).ready(function(){$('#btnCreateCategory').click(function(){var text=$('#txtCat').val().trim();var regex=/\<[\S* ]*\>/;var alphaRegex=/[a-zA-Z]{1,}/;if(text.match(regex)!=null){showMessage('Category name entered is invalid');return;}
if(text.match(alphaRegex)==null){showMessage('Category name entered is invalid, should have at least 1 alphabet');return;}
if(text!=''&&text.length<=50){ajaxAddPartial(text);}
else{showMessage('Category name cannot be more than 50 characters');}});});function ajaxAddPartial(text){$.ajax({type:'GET',url:'/Admin/CategoryAdmin/AddCategoryPartial',data:{'categoryName':text,'token':$('#OneTimeCode').val()},dataType:'html',success:function(data){if(data.trim()!=''){$('#manage-table tbody tr:first').before(data);$('.add-msg').html('');var zeroRow=$('tr.manage-row');if(zeroRow.length==1){$(zeroRow).remove();}}
else{$('.add-msg').html('category already exists').show('slow');setTimeout(function(){$('.add-msg').html('');},2000);}
$('#txtCat').val('');},error:function(req,status,err){alert('an error occurred while trying to add the category entered, please try again.');}});}
$('.deactivateAuthor').live('click',function(e){e.preventDefault();var element=this;var url=$(element).attr('href')+"&token="+$('#OneTimeCode').val();$.ajax({type:'GET',url:url,dataType:'json',success:function(data){if(data==true){var newUrl=$(element).attr('href');var statusElement=$(element).parent().parent().find('td:eq(3)');if(newUrl.indexOf('currentStatus=1')>=0){$(element).html('activate');newUrl=newUrl.replace("currentStatus=1","currentStatus=0");$(element).attr('href',newUrl);$(statusElement).html('Inactive');}
else{$(element).html('deactivate');newUrl=newUrl.replace("currentStatus=0","currentStatus=1");$(element).attr('href',newUrl);$(statusElement).html('Active');}}},error:function(req,status,err){alert('an error occurred while trying activate/deactivate the selected author, please try again.');}});});$(function(){$('#username').focus(function(){$(this).val('');}).focusout(function(){if($(this).val()==''){$(this).val('username');}});$('#emailAddress').focus(function(){$(this).val('');}).focusout(function(){if($(this).val()==''){$(this).val('your email address');}});$('#fake-password').focus(function(){$(this).hide();$('#passwd').val('').show().focus();});$('#passwd').focusout(function(){if($(this).val()==''){$(this).val('password').hide();$('#fake-password').val('password').show();}});$('input:text,input:password').focus(function(){$(this).parent().next('.field-info').show();}).blur(function(){$(this).parent().next('.field-info').hide();});$('#showOptions').click(function(){$('.remember-me').toggle('slow');});$('#requestAccount').click(function(){$('#request-account').hide();$('#requestResults').html('');$('.request-form-content input:text,textarea').val('');resetValidation();$('.request-form').show();$('.request-form-content input:text:eq(0)').focus();});$('#sendRequest').click(function(e){e.preventDefault();var regex=/\<[\S* ]*\>/;var validateErrors=null;$('.validate-html').each(function(){if(validateErrors==null&&$(this).val().trim()!=''&&$(this).val().match(regex)!=null){validateErrors=this;}});if(validateErrors!=null){$(validateErrors).focus();alert('Field contains invalid content (like html tags)');return;}
$('#requestAccountFrm').submit();});$('.closeWindow,#closeForm').click(function(){showRequestAccountLink();});$(document).keyup(function(e){var requestForm=$('.request-form');if(requestForm.length==1&&e.keyCode==27){if($(requestForm).is(':visible')){showRequestAccountLink();}}});});function showRequestAccountLink(){$('.request-form').hide();$('#request-account').show();}
function resetValidation(){$('.request-form-content .input-validation-error').addClass('input-validation-valid');$('.request-form-content .input-validation-error').removeClass('input-validation-error');$('.request-form-content .field-validation-error').addClass('field-validation-valid');$('.request-form-content .field-validation-error').removeClass('field-validation-error');}
function savePostOrPage(){if(!canBeSavedPartially()){setTimeout(function(){savePostOrPage();},30000);return;}
if(!$('.privateChkBox').is(':checked')){$('.privateChkBox').trigger('click');}
var rUrl=($('#AjaxSaved').val().toLowerCase()=='true'||/(post\/edit)/i.test(document.location.href))?'edit':'add';var formData=$('form').serializeArray();$.ajax({type:'POST',url:siteRoot+'admin/post/'+rUrl,data:formData,dataType:'json',success:function(data){if(data.IsValid){$('#AjaxSaved').val(true);$('#Post_PostID').val(data.PostId);var msg='Saved a draft of your post at <b>'+getCurrentDateTime()+'</b>';$('#updateAjaxStatus').html(msg).show();}
setTimeout(function(){savePostOrPage();},30000);}});}
function canBeSavedPartially(){var postTitle=$('#Post_PostTitle').val();var postUrl=$('#Post_PostUrl').val();var pattern=/.*\S.*/;if(!pattern.test(postTitle)||!pattern.test(postUrl)){return false;}
return true;}
function getCurrentDateTime(){var now=new Date();var year=""+now.getFullYear();var month=""+(now.getMonth()+1);if(month.length==1){month="0"+month;}
var day=""+now.getDate();if(day.length==1){day="0"+day;}
var hour=""+now.getHours();if(hour.length==1){hour="0"+hour;}
var minute=""+now.getMinutes();if(minute.length==1){minute="0"+minute;}
var second=""+now.getSeconds();if(second.length==1){second="0"+second;}
return month+"/"+day+"/"+year+" "+hour+":"+minute+":"+second;}
function showHideMarkdownHelp(val){if(val=='markdown'){$('#markdownHelp').show();}else{$('#markdownHelp').hide();}}